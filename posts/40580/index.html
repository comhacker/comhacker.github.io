<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":"ture","show_result":"ture","style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":"ture"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":"ture","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="练武题RESR脱壳之后打开   在比较函数处设置断点，动调得到flag   我爱看小品  python写的elf文件，使用pyinstxtractor.py脚本处理（注意，必须要在3.8的环境）   使用pycdc反编译pyc文件：   引用了mypy和yourpy两个库。去PYZ-00.pyz_extracted文件夹下找，没找到同名pyc文件，但是有.pyc.encrypted文件 。这种">
<meta property="og:type" content="article">
<meta property="og:title" content="iscc">
<meta property="og:url" content="http://example.com/posts/40580/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="练武题RESR脱壳之后打开   在比较函数处设置断点，动调得到flag   我爱看小品  python写的elf文件，使用pyinstxtractor.py脚本处理（注意，必须要在3.8的环境）   使用pycdc反编译pyc文件：   引用了mypy和yourpy两个库。去PYZ-00.pyz_extracted文件夹下找，没找到同名pyc文件，但是有.pyc.encrypted文件 。这种">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/posts/40580/image-20250501195702098.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250501195758440.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250501202304564.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250501202614840.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250501202730601.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250501203831664.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250501204050505.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250502174522457.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250502174725308.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250502182009921.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250507123646619.png">
<meta property="og:image" content="http://example.com/posts/40580/image-20250507124104236.png">
<meta property="article:published_time" content="2025-05-01T11:53:27.000Z">
<meta property="article:modified_time" content="2025-05-28T07:59:21.058Z">
<meta property="article:author" content="comhacker">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/posts/40580/image-20250501195702098.png">

<link rel="canonical" href="http://example.com/posts/40580/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>iscc | Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/40580/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar_2.gif">
      <meta itemprop="name" content="comhacker">
      <meta itemprop="description" content="位卑未敢忘忧国，事定犹须待阖棺">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          iscc
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-01 19:53:27" itemprop="dateCreated datePublished" datetime="2025-05-01T19:53:27+08:00">2025-05-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-05-28 15:59:21" itemprop="dateModified" datetime="2025-05-28T15:59:21+08:00">2025-05-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <span id="more"></span>

<h1 id="练武题"><a href="#练武题" class="headerlink" title="练武题"></a>练武题</h1><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="SR"><a href="#SR" class="headerlink" title="SR"></a>SR</h3><p>脱壳之后打开</p>
<img src="/posts/40580/image-20250501195702098.png" class="" title="image-20250501195702098">

<p>在比较函数处设置断点，动调得到flag</p>
<img src="/posts/40580/image-20250501195758440.png" class="" title="image-20250501195758440">

<h3 id="我爱看小品"><a href="#我爱看小品" class="headerlink" title="我爱看小品"></a>我爱看小品</h3><img src="/posts/40580/image-20250501202304564.png" class="" title="image-20250501202304564">

<p>python写的elf文件，使用pyinstxtractor.py脚本处理（注意，必须要在3.8的环境）</p>
<img src="/posts/40580/image-20250501202614840.png" class="" title="image-20250501202614840">

<p>使用pycdc反编译pyc文件：</p>
<img src="/posts/40580/image-20250501202730601.png" class="" title="image-20250501202730601">

<p>引用了mypy和yourpy两个库。去PYZ-00.pyz_extracted文件夹下找，没找到同名pyc文件，但是有.pyc.encrypted文件</p>
<p>。这种文件是加了密的pyc文件，加密密钥在pyimod00_crypto_key.pyc文件里面：</p>


<p>使用解密：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import zlib, tinyaes</span><br><span class="line">from pathlib import Path</span><br><span class="line"></span><br><span class="line"># 配置参数</span><br><span class="line">CRYPT_BLOCK_SIZE = 16</span><br><span class="line">key = bytes(&#x27;yibaibayibei1801&#x27;, &#x27;utf-8&#x27;)  # 直接使用你的密钥</span><br><span class="line">input_file = Path(&quot;D:\\Re\\python逆向\\mypy.pyc.encrypted&quot;)   # 要运行两次脚本得到两个pyc文件</span><br><span class="line">output_file = input_file.with_suffix(&#x27;&#x27;)  # 输出路径为 mypy.pyc</span><br><span class="line"></span><br><span class="line"># 解密核心逻辑</span><br><span class="line">with open(input_file, &#x27;rb&#x27;) as inf, open(output_file, &#x27;wb&#x27;) as outf:</span><br><span class="line">    iv = inf.read(CRYPT_BLOCK_SIZE)  # 读取初始向量</span><br><span class="line">    cipher = tinyaes.AES(key, iv)</span><br><span class="line">    encrypted_data = inf.read()  # 读取加密数据</span><br><span class="line">    decrypted_data = cipher.CTR_xcrypt_buffer(encrypted_data)  # AES-CTR解密</span><br><span class="line">    plaintext = zlib.decompress(decrypted_data)  # 解压数据</span><br><span class="line">    </span><br><span class="line">    # 修复pyc文件头（需根据Python版本调整！）</span><br><span class="line">    # Python 3.8 示例：b&#x27;\x55\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0&#x27;</span><br><span class="line">    pyc_header = b&#x27;\x55\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0&#x27;  </span><br><span class="line">    outf.write(pyc_header + plaintext)</span><br><span class="line"></span><br><span class="line">print(f&quot;[+] 解密完成: &#123;output_file&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p>得到两个.pyc文件</p>
<img src="/posts/40580/image-20250501203831664.png" class="" title="image-20250501203831664">

<p>分别反编译</p>
<p>mypy.pyc:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">def myfun():</span><br><span class="line">    part1 = &#x27;ISCC&#123;&#x27;</span><br><span class="line">    part2 = &#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span><br><span class="line">    part3 = &#x27;&#125;&#x27;</span><br><span class="line">    tmp = &#x27;&#x27;</span><br><span class="line">    part2_1 = part2[:11]</span><br><span class="line">    part2_2 = part2[11:15]</span><br><span class="line">    part2_3 = part2[15:20]</span><br><span class="line">    part2_4 = part2[20:]</span><br><span class="line">    for i in range(len(part2_1)):</span><br><span class="line">        tmp += chr(ord(part2_1[i]) + 1)</span><br><span class="line">    for i in range(len(part2_2)):</span><br><span class="line">        if part2_2[i].isalpha():</span><br><span class="line">            tmp += chr(ord(part2_2[i]) ^ 32)</span><br><span class="line">            continue</span><br><span class="line">        tmp += chr(ord(part2_2[i]) + 0)</span><br><span class="line">    for i in range(len(part2_3)):</span><br><span class="line">        tmp += chr(ord(part2_3[i]) - 1)</span><br><span class="line">    for i in range(len(part2_4)):</span><br><span class="line">        tmp += chr(ord(part2_4[i]) + i % 2)</span><br><span class="line">    cipher = &#x27;qzjotubmmfs_IS_udqx^iotfrfsuiog&#x27;</span><br><span class="line">    true_flag = part1 + part2 + part3</span><br><span class="line">    print(time.strftime(&#x27;%Y-%m-%d %H:%M&#x27;, time.localtime(time.time())))</span><br><span class="line">    return true_flag</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    ss = myfun()</span><br><span class="line">    print(ss)</span><br></pre></td></tr></table></figure>

<p>yourpy.pyc:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def next():</span><br><span class="line">Unsupported opcode: BEGIN_FINALLY</span><br><span class="line">    useful = &#x27;\n\n                                                                                       ,---,\n                                                                                    ,`--.\&#x27; |\n  ,--,                            ,-.           ,---,                               |   :  :\n,--.\&#x27;|                        ,--/ /|         ,--.\&#x27; |                               \&#x27;   \&#x27;  ;\n|  | :     ,---.     ,---.  ,--. :/ |         |  |  :                __  ,-.        |   |  |\n:  : \&#x27;    \&#x27;   ,\&#x27;\\   \&#x27;   ,\&#x27;\\ :  : \&#x27; /          :  :  :              ,\&#x27; ,\&#x27;/ /|        \&#x27;   :  ;\n|  \&#x27; |   /   /   | /   /   ||  \&#x27;  /           :  |  |,--.   ,---.  \&#x27;  | |\&#x27; | ,---.  |   |  \&#x27;\n\&#x27;  | |  .   ; ,. :.   ; ,. :\&#x27;  |  :           |  :  \&#x27;   |  /     \\ |  |   ,\&#x27;/     \\ \&#x27;   :  |\n|  | :  \&#x27;   | |: :\&#x27;   | |: :|  |   \\          |  |   /\&#x27; : /    /  |\&#x27;  :  / /    /  |;   |  ;\n\&#x27;  : |__\&#x27;   | .; :\&#x27;   | .; :\&#x27;  : |. \\         \&#x27;  :  | | |.    \&#x27; / ||  | \&#x27; .    \&#x27; / |`---\&#x27;. |\n|  | \&#x27;.\&#x27;|   :    ||   :    ||  | \&#x27; \\ \\        |  |  \&#x27; | :\&#x27;   ;   /|;  : | \&#x27;   ;   /| `--..`;\n;  :    ;\\   \\  /  \\   \\  / \&#x27;  : |--\&#x27;         |  :  :_:,\&#x27;\&#x27;   |  / ||  , ; \&#x27;   |  / |.--,_\n|  ,   /  `----\&#x27;    `----\&#x27;  ;  |,\&#x27;            |  | ,\&#x27;    |   :    | ---\&#x27;  |   :    ||    |`.\n ---`-\&#x27;                     \&#x27;--\&#x27;              `--\&#x27;\&#x27;       \\   \\  /         \\   \\  / `-- -`, ;\n                                                           `----\&#x27;           `----\&#x27;    \&#x27;---`&quot;\n\n\n    \n&#x27;</span><br><span class="line">    tips = &#x27;Congratulations, you found the hidden tip!&#x27;</span><br><span class="line">    your_id = &#x27;TIPO&#x27; + str(len(tips)) + &#x27;PCDL&#x27;</span><br><span class="line"># WARNING: Decompyle incomplete</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    next()</span><br></pre></td></tr></table></figure>

<img src="/posts/40580/image-20250501204050505.png" class="" title="image-20250501204050505">

<p>flag和yourpy.pyc无关，只需要解mypy.pyc里面的加密就行，稍微改一下加密脚本就能实现解密：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">def myfun():</span><br><span class="line">    part1 = &#x27;ISCC&#123;&#x27;</span><br><span class="line">    part2 = &#x27;qzjotubmmfs_IS_udqx^iotfrfsuiog&#x27;</span><br><span class="line">    part3 = &#x27;&#125;&#x27;</span><br><span class="line">    tmp = &#x27;&#x27;</span><br><span class="line">    part2_1 = part2[:11]</span><br><span class="line">    part2_2 = part2[11:15]</span><br><span class="line">    part2_3 = part2[15:20]</span><br><span class="line">    part2_4 = part2[20:]</span><br><span class="line">    for i in range(len(part2_1)):</span><br><span class="line">        tmp += chr(ord(part2_1[i]) - 1)</span><br><span class="line">    for i in range(len(part2_2)):</span><br><span class="line">        if part2_2[i].isalpha():</span><br><span class="line">            tmp += chr(ord(part2_2[i]) ^ 32)</span><br><span class="line">            continue</span><br><span class="line">        tmp += chr(ord(part2_2[i]) + 0)</span><br><span class="line">    for i in range(len(part2_3)):</span><br><span class="line">        tmp += chr(ord(part2_3[i]) + 1)</span><br><span class="line">    for i in range(len(part2_4)):</span><br><span class="line">        tmp += chr(ord(part2_4[i]) - i % 2)</span><br><span class="line">    cipher = &#x27;qzjotubmmfs_IS_udqx^iotfrfsuiog&#x27;</span><br><span class="line">    true_flag = part1 + part2 + part3</span><br><span class="line">    print(time.strftime(&#x27;%Y-%m-%d %H:%M&#x27;, time.localtime(time.time())))</span><br><span class="line">    return tmp</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    ss = myfun()</span><br><span class="line">    print(ss)</span><br><span class="line"> //ISCC&#123;pyinstaller_is_very_interesting&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="书法大师"><a href="#书法大师" class="headerlink" title="书法大师"></a>书法大师</h3><p>使用binwalk提取图片：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e attachment-5.jpg</span><br></pre></td></tr></table></figure>

<p>得到_attachment-5.jpg.extracted文件夹。里面有一个压缩包，需要密码。使用在线网站查看图片注释，得到解压密码：</p>
<img src="/posts/40580/image-20250502174522457.png" class="" title="image-20250502174522457">

<p>解压得到message45.txt文件，里面是乱码</p>
<img src="/posts/40580/image-20250502174725308.png" class="" title="image-20250502174725308">

<p>每两个汉字的笔划组成一个字节，比如“右女”笔划数分别为5和3，组成0x53（这里的O代表笔划为0），通过此方法得到：</p>
<p>SVNDQ3swVzdVTnpBZ0NofQ&#x3D;&#x3D;</p>
<p>解码</p>
<img src="/posts/40580/image-20250502182009921.png" class="" title="image-20250502182009921">

<h2 id="mobile-安卓"><a href="#mobile-安卓" class="headerlink" title="mobile(安卓)"></a>mobile(安卓)</h2><h3 id="三进制战争"><a href="#三进制战争" class="headerlink" title="三进制战争"></a>三进制战争</h3><p>使用frida hook得flag，注入代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">import frida</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">hook_code = &quot;&quot;&quot;</span><br><span class="line">Java.perform(function () &#123;</span><br><span class="line">    let MainActivity = Java.use(&quot;com.example.mobile02.MainActivity&quot;);</span><br><span class="line">    let flag1 = &#x27;&#x27;;</span><br><span class="line">    let key2 = &#x27;&#x27;;</span><br><span class="line">    let flag2_enc = &#x27;&#x27;;</span><br><span class="line">    let flag2 = &#x27;&#x27;;</span><br><span class="line">    var dictionary = [&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;];</span><br><span class="line">    let context;</span><br><span class="line">    </span><br><span class="line">    // ====================================================</span><br><span class="line">    // 1. 修复：正确保存原始方法引用</span><br><span class="line">    // ====================================================</span><br><span class="line">    // 获取原始方法引用（未 Hook 前）</span><br><span class="line">    const stringFromJNlMethod = MainActivity[&quot;stringFromJNl&quot;].overload(</span><br><span class="line">        &#x27;java.lang.String&#x27;,</span><br><span class="line">        &#x27;java.lang.String&#x27;</span><br><span class="line">    );</span><br><span class="line">    const stringFromJNlMethod_1 = MainActivity[&quot;stringFromJNI&quot;].overload(</span><br><span class="line">        &#x27;java.lang.String&#x27;</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    // ====================================================</span><br><span class="line">    // 2. Hook CHECK1 修改输入</span><br><span class="line">    // ====================================================</span><br><span class="line">    MainActivity[&quot;CHECK1&quot;].overload(&#x27;java.lang.String&#x27;).implementation = function (str) &#123;</span><br><span class="line">        console.log(`[CHECK1] Original input: $&#123;str&#125;`);</span><br><span class="line">        let fakeStr = &quot;ISCC&#123;BBBBBBBBBB&#125;&quot;; // 长度=5+10+1=16 &gt;13</span><br><span class="line">        </span><br><span class="line">        if (str.startsWith(&quot;ISCC&#123;&quot;) &amp;&amp; str.endsWith(&quot;&#125;&quot;)) &#123;</span><br><span class="line">            fakeStr = str;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        context = this;</span><br><span class="line">        console.log(`[CHECK1] Modified input: $&#123;fakeStr&#125;`);</span><br><span class="line">        this[&quot;CHECK2&quot;].call(this, fakeStr);</span><br><span class="line">        return this[&quot;CHECK1&quot;](fakeStr);</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    // ====================================================</span><br><span class="line">    // 3. Hook stringFromJNl 并调用原始方法</span><br><span class="line">    // ====================================================</span><br><span class="line">    stringFromJNlMethod.implementation = function (key, input) &#123;</span><br><span class="line">        console.log(`\\n===== Hooked stringFromJNl: key=$&#123;key&#125;, input=$&#123;input&#125; =====`);</span><br><span class="line">        if (key.length == 32) &#123;</span><br><span class="line">            key2 = key;</span><br><span class="line">        &#125;</span><br><span class="line">        return stringFromJNlMethod.call(this, key, input);</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    stringFromJNlMethod_1.implementation = function (key) &#123;</span><br><span class="line">        flag1 = stringFromJNlMethod_1.call(this, key);</span><br><span class="line">        console.log(`flag1: $&#123;flag1&#125;`);</span><br><span class="line">        return flag1;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    let Intrinsics = Java.use(&quot;kotlin.jvm.internal.Intrinsics&quot;);</span><br><span class="line">    Intrinsics[&quot;areEqual&quot;].overload(&#x27;java.lang.Object&#x27;, &#x27;java.lang.Object&#x27;).implementation = </span><br><span class="line">        function (obj, obj2) &#123;</span><br><span class="line">            console.log(`[areEqual] Comparing: $&#123;obj&#125; vs $&#123;obj2&#125;`);</span><br><span class="line">            </span><br><span class="line">            if (String(obj2).length == 36) &#123;</span><br><span class="line">                flag2_enc = String(obj2);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            const visibleChars = [];</span><br><span class="line">            </span><br><span class="line">            if (key2.length == 32 &amp;&amp; flag2_enc.length == 36) &#123;</span><br><span class="line">                for (let i = 0x20; i &lt;= 0x7e; i++) &#123;</span><br><span class="line">                    visibleChars.push(String.fromCharCode(i));</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                visibleChars.forEach(char =&gt; &#123;</span><br><span class="line">                    const inputStr = char.repeat(6);</span><br><span class="line">                    try &#123;</span><br><span class="line">                        const result = stringFromJNlMethod.call(context, key2, inputStr);</span><br><span class="line">                        console.log(result);</span><br><span class="line">                        </span><br><span class="line">                        for (let i = 0; i &lt; 6; i += 1) &#123;</span><br><span class="line">                            dictionary[i][result.substring(i * 6, (i + 1) * 6)] = inputStr.at(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; catch (e) &#123;</span><br><span class="line">                        console.log(`输入 &#x27;$&#123;inputStr&#125;&#x27; 加密失败: $&#123;e&#125;`);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                for (let i = 0; i &lt; 6; i += 1) &#123;</span><br><span class="line">                    flag2 += dictionary[i][flag2_enc.substring(i * 6, (i + 1) * 6)];</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                console.log(`flag2: $&#123;flag2&#125;`);</span><br><span class="line">                console.log(`flag: ISCC&#123;$&#123;flag1 + flag2&#125;&#125;`);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            return this[&quot;areEqual&quot;](obj, obj2);</span><br><span class="line">        &#125;;</span><br><span class="line">&#125;);</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def handle_message(msg, data):</span><br><span class="line">    if msg[&quot;type&quot;] == &#x27;send&#x27;:</span><br><span class="line">        print(&quot;[*] &#123;0&#125;&quot;.format(msg[&#x27;payload&#x27;]))</span><br><span class="line">    else:</span><br><span class="line">        print(msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    device = frida.get_usb_device()</span><br><span class="line">    pid = device.spawn([&quot;com.example.mobile02&quot;])</span><br><span class="line">    session = device.attach(pid)</span><br><span class="line">    script = session.create_script(hook_code)</span><br><span class="line">    script.on(&quot;message&quot;, handle_message)</span><br><span class="line">    script.load()</span><br><span class="line">    device.resume(pid)</span><br><span class="line">    sys.stdin.read()</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(f&quot;Error: &#123;e&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p>注入流程：</p>
<p>先打开模拟器</p>
<p>然后电脑开启终端，依次输入以下指令来运行模拟器里面的frida_server：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">adb devices</span><br><span class="line">adb shell</span><br><span class="line">su</span><br><span class="line">cd data/local/tmp</span><br><span class="line">./f16</span><br></pre></td></tr></table></figure>

<img src="/posts/40580/image-20250507123646619.png" class="" title="image-20250507123646619">

<p>模拟器安装题目的apk文件，运行</p>
<p>电脑运行脚本</p>
<p>模拟器点击特定事件（比如submit)</p>
<p>在终端上观察</p>
<img src="/posts/40580/image-20250507124104236.png" class="" title="image-20250507124104236">

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/wp/" rel="tag"><i class="fa fa-tag"></i> wp</a>
          </div>

        
  <div class="post-widgets">
    <div class="wp_rating">
      <div id="wpac-rating"></div>
    </div>
  </div>


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/55434/" rel="prev" title="操作系统复习">
      <i class="fa fa-chevron-left"></i> 操作系统复习
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/54083/" rel="next" title="ISCC区域赛wp">
      ISCC区域赛wp <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98"><span class="nav-number">1.</span> <span class="nav-text">练武题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#RE"><span class="nav-number">1.1.</span> <span class="nav-text">RE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SR"><span class="nav-number">1.1.1.</span> <span class="nav-text">SR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%91%E7%88%B1%E7%9C%8B%E5%B0%8F%E5%93%81"><span class="nav-number">1.1.2.</span> <span class="nav-text">我爱看小品</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">1.2.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A6%E6%B3%95%E5%A4%A7%E5%B8%88"><span class="nav-number">1.2.1.</span> <span class="nav-text">书法大师</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mobile-%E5%AE%89%E5%8D%93"><span class="nav-number">1.3.</span> <span class="nav-text">mobile(安卓)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E8%BF%9B%E5%88%B6%E6%88%98%E4%BA%89"><span class="nav-number">1.3.1.</span> <span class="nav-text">三进制战争</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="comhacker"
      src="/images/avatar_2.gif">
  <p class="site-author-name" itemprop="name">comhacker</p>
  <div class="site-description" itemprop="description">位卑未敢忘忧国，事定犹须待阖棺</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">37</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">comhacker</span>
</div>
<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  



  <script>
  if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id    : ,
      el    : 'wpac-rating',
      color : 'fc6423'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }
  </script>

  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
